# Characters and Strings

Formal definitions for character and string types in programming languages are often left as footnotes, and in particular the question of what a `char` value actually _is_ can often be confusing.

Both for pragmatic and platonic reasons, I think it makes sense for Jabber to follow in Scheme and Rust's footsteps: the `char` type should represent the space of Unicode scalar values, and the `string` type should be a sequence of `char` values.

Scheme and Rust differ slightly in the guarantees they make about the underlying representation of strings. Rust explicitly defines strings as sequences of bytes that *happen* to be valid UTF-8, while Scheme only defines them to be sequences of characters; Scheme makes no claims about the memory layout of string objects, and indeed all string/bytevector conversion functions in the R6RS bytevector library[^2] (ยง2.9) explicitly state that they allocate new objects.

## Extant Definitions
- Javascript's `String` is a sequence of unsigned 16-bit integers, and codepoints are divided into [surrogate pairs](https://www.unicode.org/glossary/#surrogate_pair) as necessary. Characters are represented as a `String` containing ["a single element"](https://tc39.es/ecma262/multipage/text-processing.html#sec-string.prototype.charat).
- Python's `str` is ["a sequence of values that represent Unicode code points"](https://docs.python.org/3/reference/datamodel.html#immutable-sequences), and characters are represented as string objects with length `1`.
- Julia's `String` type is defined as a sequence of `Char` values, which may or may not be backed by a valid sequence of UTF-8 bytes. The `Char` type is a 32-bit unsigned integer which [may or may not be a valid Unicode codepoint](https://docs.julialang.org/en/v1/manual/strings/#man-characters).
- R6RS Scheme defines characters as "objects that represent Unicode scalar values" (ยง11.11), and strings are then defined as sequences of characters (ยง11.12).[^1]
- Rust defines strings [(i.e. the owned `String` and borrowed `&str` types)](https://doc.rust-lang.org/std/string/struct.String.html) as sequences of bytes, which are guaranteed to be valid UTF-8. The [`char` type](https://doc.rust-lang.org/std/primitive.char.html) corresponds exactly to the range of [Unicode scalar values](https://www.unicode.org/glossary/#unicode_scalar_value).

[^1]: [The R6RS specification](https://www.r6rs.org/final/r6rs.pdf)
[^2]: [The R6RS library specification](https://www.r6rs.org/final/r6rs-lib.pdf)